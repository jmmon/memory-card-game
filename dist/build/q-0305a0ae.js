import{l as n,G as b,I as R,q as k,C as A,m as S,h as P,$ as y,c as d,_ as c,w as E,x as w,p as T}from"./q-b0c5ea11.js";import{i as O,h as z,C as V,a as I,f as L,c as M}from"./q-3ab09907.js";import{A as x}from"./q-01d7dbd8.js";import{V as W}from"./q-ad44cc7e.js";import{g as B,f as D,v as G}from"./q-a5436561.js";const N=s=>{const[e]=n();return e(s)},H=s=>{const[e,a]=n();if(e.boardLayout.isLocked)return;const r=s.target.innerWidth;console.log("resize:",{e:s,width:r}),a(r-32)},$=s=>{var l,g;const[e,a]=n(),r=e.game.flippedCardId!==-1,t=Number((g=(l=s.target)==null?void 0:l.dataset)==null?void 0:g.id)||!1,o=!!t;switch(!0){case r:e.game.selectedCardIds.length===2&&a(),e.game.flippedCardId=-1;break;case o:{const _=t;if(O(e.game.successfulPairs,_))return;const m=z([...e.game.selectedCardIds],_);m&&(e.game.selectedCardIds=m,e.game.flippedCardId=_)}break}},q=(s,e)=>{var p,C;const[a,r]=n(),t=s||((p=r.value)==null?void 0:p.offsetWidth)||0,o=e||((C=r.value)==null?void 0:C.offsetHeight)||0,l=t*o,g=l/a.settings.deck.size,_=Math.sqrt(g*I),f=Math.floor(t/_),m=Math.ceil(a.settings.deck.size/f),h=o/m,u=h*I,v=u*h;a.cardLayout={width:u,height:h,roundedCornersPx:V*u,area:v},a.boardLayout={...a.boardLayout,width:t,height:o,area:l,rows:m,columns:f},console.log({board:a.boardLayout,card:a.cardLayout,columns:f,rows:m})},F=()=>{const[s]=n(),[e,a]=s.game.selectedCardIds,r=`${e}:${a}`,t=L(s.game.cards,e),o=L(s.game.cards,a);M(t,o)?s.game.successfulPairs=[...s.game.successfulPairs,r]:(s.game.mismatchPairs=[...s.game.mismatchPairs,r],t&&(t.isMismatched=!0),o&&(o.isMismatched=!0)),s.game.selectedCardIds=[]},j=()=>{const[s]=n();console.log("board useVisibleTask"),s()},K=()=>{const s=b(x),e=R(),a=d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_dsyKGLKR1Ck",[s,e]),t=d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_NL6V7x0zOSY",[s,d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_JRgnoGq6tYQ",[s])]);return k("resize",d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_ceNhLFfitRE",[s,a])),A(d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_SV07HUN2bfc",[s,a])),S(d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_XjSHQFfr864",[a])),P(w,{children:y("div",{ref:e},{class:"grid max-w-full",onClick$:d(()=>c(()=>Promise.resolve().then(()=>i),void 0),"s_BkWcp01cGwo",[t]),style:E(o=>({gridTemplateColumns:`repeat(${o.boardLayout.columns||4}, 1fr)`,gridTemplateRows:`repeat(${o.boardLayout.rows}, 1fr)`}),[s])},s.game.cards.map(o=>P(W,{card:o},3,"0C_0")),1,null)},1,"0C_1")},Q=async s=>{const[e,a]=n();if(s.track(()=>e.settings.deck.size),e.settings.deck.isLocked)return;e.game.isLoading=!0;let r=[];try{r=await B(e.settings.deck.size)}catch(t){console.log("card API error:",{err:t})}r!==void 0&&r.length>0?e.game.cards=D(r):(e.game.cards=G(e.settings.deck.size),console.log("-- defaulting to old cards:",{cards:e.game.cards})),e.shuffleCardPositions(),e.game.selectedCardIds=[],e.game.flippedCardId=-1,e.game.mismatchPairs=[],e.game.successfulPairs=[],e.game.isLoading=!1,!e.boardLayout.isLocked&&a()},i=Object.freeze(Object.defineProperty({__proto__:null,_hW:T,s_BkWcp01cGwo:N,s_JRgnoGq6tYQ:F,s_NL6V7x0zOSY:$,s_SV07HUN2bfc:Q,s_XjSHQFfr864:j,s_ceNhLFfitRE:H,s_dsyKGLKR1Ck:q,s_qw05vrxWP0A:K},Symbol.toStringTag,{value:"Module"}));export{T as _hW,N as s_BkWcp01cGwo,F as s_JRgnoGq6tYQ,$ as s_NL6V7x0zOSY,Q as s_SV07HUN2bfc,j as s_XjSHQFfr864,H as s_ceNhLFfitRE,q as s_dsyKGLKR1Ck,K as s_qw05vrxWP0A};
